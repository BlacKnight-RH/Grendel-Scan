use strict;
my (@list, $word, %words, $fh);
getList();


for $word(@list)
{
	my $count = 0;
	my $text = `curl --user-agent "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13" http://search.yahoo.com/search?p=inurl%3A$word`;
	if ($text =~ /\d+ - \d+ of (?:about )?([0-9,]+) for <strong>/i)
	{
		$count = $1;
		$count =~ s/,//g;
		$words{$word} += $count;	
	}
	print "tested $word - $count\n\n";
}

open($fh, ">yahoo_dir_results.xls");
for $word (sort {$words{$b} <=> $words{$a}} keys(%words))
{
	print $fh "$word\t$words{$word}\n";
}
close($fh);

sub getList
{
	@list = qw(
search97
secret
secrets
secure
secured
security
sell
serve
server-info
server-status
servers
serverstats
server_stats
service
services
servicio
servicios
servlet
servlets
session
setup
share
shared
shell-
shipping
shop
shopper
shopping
SilverStream
site
siteadmin
sitebuildercontent
sitebuilderfiles
sitebuilderpictures
sitemgr
siteminder
siteminderagent
sites
SiteServer
sitestats
siteupdate
slide
smreports
smreportsviewer
soap
soapdocs
software
solaris
solutions
source
sql
squid
squirrelmail
src
srchadm
ssi
ssl
sslkeys
staff
stat
statistic
statistics
stats
stats-bin-p
stats_old
status
storage
store
StoreDB
storemgr
stronghold-info
stronghold-status
stuff
style
styles
stylesheet
stylesheets
subir
sun
super_stats
support
supporter
sys
sysadmin
sysbackup
system
tar
tarantella
tarjetas
tdbin
tech
technote
temp
template
Templates
temporal
temps
test
test-cgi
testing
tests
testweb
text
texts
te_html
themes
ticket
tickets
tmp
ToDo
tools
tor
totaller
tpdadvsearch
tpv
trabajo
track
tracking
transito
transpolar
tree
trees
updates
upload
uploadfiles
uploads
urchin
urchin3
urchin5
us
usage
user
userdb
users
usr
ustats
usuario
usuarios
util
utils
v4
var
vb
vbs
vbscript
vbscripts
vfs
visitor
w-agora
w3perl
W3SVC
W3SVC3
wavemaster.internal
way-board
web
WEB-INF
web800fo
webaccess
webadmin
webalizer
webapps
WebBank
webboard
WebCalendar
webcart
webcart-lite
webdata
WebDB
webimages
webimages2
weblog
weblogic
weblogs
webmail
webmaster
webmaster_logs
webMathematica
webpub
webpub-ui
webreports
webreps
webshare
WebShop
website
webstat
webstats
webtrace
WebTrend
webtrends
Web_store
web_usage
windows
word
work
wsdocs
WSsamples
wstats
wusage
wws
www
www-sql
wwwjoin
wwwlog
wwwstat
wwwstats
xampp
xcache
xGB
xml
XSL
xsql
xtemp
zb41
zip
zipfiles
zips
_admin
_backup
_derived
_errors
_fpclass
_mem_bin
_notes
_objects
_old
_pages
_passwords
_private
_ScriptLibrary
_scripts
_sharedtemplates
_tests
_themes
_vti_bin
_vti_bot
_vti_log
_vti_pvt
_vti_shm
_vti_txt
~1
~adm
~admin
~administrator
~guest
~log
~mail
~operator
~root
~stats
~sys
~sysadm
~sysadmin
~test
~user
~webmaster
~webstats
~wsdocs
~www
);
}